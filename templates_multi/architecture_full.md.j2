<!-- architecture_full.md.j2 : template complet -->
# Dossier d’architecture – {{ project.Context }}

---

{% include "chapters/01_context.md.j2" %}

---

{% include "chapters/02_constraints.md.j2" %}

---

{% include "chapters/03_process.md.j2" %}

---

{% include "chapters/04_data.md.j2" %}

---

{% include "chapters/05_positionnement_si.md.j2" %}

---

{% include "chapters/06_exigences.md.j2" %}

---
{% include "chapters/06_exigences.md.j2" %}

## 7 · Solution applicative – Vue d’ensemble
---
```plantuml
!include diagrams/overview.puml
```

---

{% include "chapters/08_solution_detail.md.j2" %}

---

## 9 · Matrice de flux / échanges

| ID | Source | Cible | Protocole | Format | Processus |
|----|--------|-------|-----------|--------|-----------|
{% for f in flows %}
| {{ f.ID }} | {{ f.Outbound }} | {{ f.Inbound }} | {{ f.Protocol }} | {{ f.Format }} | {{ f.BusinessProcess }} |
{% endfor %}

```mermaid
flowchart LR
{% for f in flows %}
    {{ f.Outbound }} -->|{{ f.Protocol }}| {{ f.Inbound }}
{% endfor %}
```

---

## 10 · Architecture technique / Infrastructure

### 10.1 Vue infra (diagramme)
```plantuml
!include diagrams/infrastructure.puml
```

### 10.2 Détails des ressources
| Layer | Service | SLA |
|-------|---------|-----|
{% for r in infra %}
| {{ r.Layer }} | {{ r.Service }} | {{ r.SLA }} |
{% endfor %}

---

## 11 · Vue sécurité

```plantuml
!include diagrams/security.puml
```

### 11.1 Contrôles & zones
| Zone | Contrôle | Outil |
|------|----------|-------|
{% for z in securityarch %}
| {{ z.Zone }} | {{ z.ControlType }} | {{ z.Tool }} |
{% endfor %}

---

## 12 · Gouvernance, exploitation & plan de migration

### 12.1 RACI
| Rôle | Responsable |
|------|-------------|
{% for r in ops %}
| {{ r.RACI_Role }} | {{ r.Owner }} |
{% endfor %}

### 12.2 Processus d’exploitation
{% for r in ops %}
- {{ r.Runbook }}
{% endfor %}

### 12.3 Plan de migration
*(À compléter)*

---

## 13 · Annexes

### 13.1 Glossaire
{% for a in annexes if a.Type == 'Glossaire' %}
{{ a.Content }}
{% endfor %}

### 13.2 Références
{% for a in annexes if a.Type == 'Référence' %}
- {{ a.Content }}
{% endfor %}

### 13.3 Hypothèses / Décisions / Risques
{% for a in annexes if a.Type in ['Hypothèse','Décision','Risque'] %}
- ({{ a.Type }}) {{ a.Content }}
{% endfor %}
